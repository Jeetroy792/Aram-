# ЁЭЦеЁЭЧВЁЭЧЕЁЭЦ╛: ЁЭЧЖЁЭЦ║ЁЭЧЗЁЭЦ║ЁЭЧАЁЭЦ╛ЁЭЧЛ.ЁЭЧЙЁЭЧТ
# ЁЭЦгЁЭЦ╛ЁЭЧМЁЭЧВЁЭЧАЁЭЧЗЁЭЦ╛ЁЭЦ╜ ЁЭЦ┐ЁЭЧИЁЭЧЛ: ЁЭЦмЁЭЦ║ЁЭЧМЁЭЧНЁЭЦ╛ЁЭЧЛ ЁЭЦйЁЭЦ╛ЁЭЦ╛ЁЭЧН [ЁЭЦдЁЭЧЕЁЭЧВЁЭЧНЁЭЦ╛ ЁЭЦдЁЭЧЗЁЭЦ╝ЁЭЧИЁЭЦ╜ЁЭЦ╛ЁЭЧЛ ЁЭЦ╖ЁЭЯл]

import asyncio
from server import start_server
from helper_agent import agent
from init_channel import InitChannel
from core import core_engine
from config import Config

class EliteManager:
    def __init__(self, client):
        self.client = client

    async def start_all_services(self):
        """
        ржЬрж┐рзО, ржПржЗ ржлрж╛ржВрж╢ржиржЯрж┐ ржмржЯрзЗрж░ рж╕ржм ржЗржЮрзНржЬрж┐ржиржХрзЗ ржПржХрж╕рж╛ржерзЗ рж╕рзНржЯрж╛рж░рзНржЯ ржХрж░ржмрзЗред
        """
        print("ЁЯЫая╕П  ЁЭЦ▓ЁЭЧНЁЭЦ║ЁЭЧЛЁЭЧНЁЭЧВЁЭЧЗЁЭЧА ЁЭЦаЁЭЧЕЁЭЧЕ ЁЭЦдЁЭЧЕЁЭЧВЁЭЧНЁЭЦ╛ ЁЭЦ▓ЁЭЦ╛ЁЭЧЛЁЭЧПЁЭЧВЁЭЦ╝ЁЭЦ╛ЁЭЧМ...")

        # рзз. ржУрзЯрзЗржм рж╕рж╛рж░рзНржнрж╛рж░ рж╕рзНржЯрж╛рж░рзНржЯ ржХрж░рж╛ (Keep-Alive ржПрж░ ржЬржирзНржп)
        try:
            start_server()
        except Exception as e:
            print(f"тЭМ ЁЭЦ▓ЁЭЦ╛ЁЭЧЛЁЭЧПЁЭЦ╛ЁЭЧЛ ЁЭЦдЁЭЧЛЁЭЧЛЁЭЧИЁЭЧЛ: {e}")

        # рзи. рж▓ржЧ ржЪрзНржпрж╛ржирзЗрж▓ ржПржмржВ ржЕрзНржпрж╛ржбржорж┐ржи ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи
        await InitChannel.setup(self.client)

        # рзй. ржмрзНржпрж╛ржХржЧрзНрж░рж╛ржЙржирзНржб ржХрзНрж▓рж┐ржиржЖржк ржПржЬрзЗржирзНржЯ ржЪрж╛рж▓рзБ ржХрж░рж╛
        asyncio.create_task(agent.clear_garbage())

        # рзк. ржХрзЛрж░ ржПржиржХрзЛржбрж┐ржВ ржУрзЯрж╛рж░рзНржХрж╛рж░ ржЪрж╛рж▓рзБ ржХрж░рж╛
        # ржПржЯрж┐ ржХрж┐ржЙ ржерзЗржХрзЗ ржПржХржЯрж╛ ржПржХржЯрж╛ ржХрж░рзЗ ржнрж┐ржбрж┐ржУ ржирж┐рзЯрзЗ ржкрзНрж░рж╕рзЗрж╕ ржХрж░ржмрзЗ
        asyncio.create_task(core_engine.worker(self.client))

        print("ЁЯЪА ЁЭЦаЁЭЧЕЁЭЧЕ ЁЭЦ▓ЁЭЧТЁЭЧМЁЭЧНЁЭЦ╛ЁЭЧЖЁЭЧМ ЁЭЦ║ЁЭЧЛЁЭЦ╛ ЁЭЦоЁЭЧЙЁЭЦ╛ЁЭЧЛЁЭЦ║ЁЭЧНЁЭЧВЁЭЧИЁЭЧЗЁЭЦ║ЁЭЧЕ!")

    @staticmethod
    async def shutdown():
        """ржмржЯ ржмржирзНржз ржХрж░рж╛рж░ рж╕ржорзЯ рж╕ржм ржЯрж╛рж╕рзНржХ рж╕рзЗржлрж▓рж┐ ржХрзНрж▓рзЛржЬ ржХрж░рж╛"""
        print("ЁЯЫС ЁЭЦ▓ЁЭЧБЁЭЧОЁЭЧНЁЭЧНЁЭЧВЁЭЧЗЁЭЧА ЁЭЦ╜ЁЭЧИЁЭЧРЁЭЧЗ ЁЭЧМЁЭЦ╛ЁЭЧЛЁЭЧПЁЭЧВЁЭЦ╝ЁЭЦ╛ЁЭЧМ...")
        # ржПржЦрж╛ржирзЗ ржкрзНрж░рзЯрзЛржЬржирзАрзЯ рж╢рж╛ржЯржбрж╛ржЙржи рж▓ржЬрж┐ржХ ржерж╛ржХржмрзЗ

